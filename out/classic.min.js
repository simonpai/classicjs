!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.classic=b()}(this,function(){var a=function(){};a.prototype.class=a;var b=function(b){b.extend=a.extend,b.mixin=a.mixin,b.isTypeOf=a.isTypeOf};a.extend=function(a){var c="function"==typeof a,d=this,e=c?Object.create(this.prototype):new this,f=function(){var b=this,e=a;if(c){var f="super"in b,g=f?b.super:null;b.super=function(){d.apply(b,arguments)},e=a.apply(b,arguments),f?b.super=g:delete b.super}for(var h in e||{})this[h]=e[h]};return f.prototype=e,f.prototype.class=f.prototype.constructor=f,f.super=this,b(f),f},a.isTypeOf=function(a){for(var b=a.class;b;b=b.super)if(b===this)return!0;return!1},a.mixin=function(a){return this.extend(a.prototype)};var c=a.extend.call(Array,function(a){if(this.super(),Array.isArray(a))for(var b=0,c=a.length;c>b;b++)this.push(a[b]);Object.defineProperty(this,"isEmpty",{get:function(){return 0==this.length}}),Object.defineProperty(this,"first",{get:function(){return this[0]}}),Object.defineProperty(this,"last",{get:function(){return this[this.length-1]}});var d=function(a){if("number"!=typeof a)throw"Index must be a number or null "+a;if(0>a||a>this.length)throw"Index out of bound: "+a+", length: "+this.length};return{contains:function(a){return!!this.indexOf(a)},add:function(a,b){null==b&&this.push(a),d(b),this.splice(b,0,a)},remove:function(a){var b=this.indexOf(a);return 0>b?!1:(this.splice(b,1),!0)},removeAt:function(a){d(a);var b=this[a];return this.splice(a,1),b}}}),d=a.extend(function(a){var b=a||{};return Object.defineProperty(this,"isEmpty",{get:function(){return 0==Object.getOwnPropertyNames(b).length}}),{get:function(a,c){var d=b[a];return void 0===d&&null!=c&&(b[a]=d="function"==typeof c?c():c),d},put:function(a,c){b[a]=c},remove:function(a){var c=b[a];return delete b[a],c},clear:function(){b={}},keys:function(){var a=new c;for(var d in b)a.push(d);return a},values:function(){var a=new c;for(var d in b)a.push(b[d]);return a},forEach:function(a){for(var c in b)a(c,b[c])}}}),e=a.extend(function(a){var b={},c=function(a){b[a]=1};if(a)if(Array.isArray(a))a.forEach(c);else for(var d in a)c(d);return Object.defineProperty(this,"isEmpty",{get:function(){return 0==Object.getOwnPropertyNames(b).length}}),{contains:function(a){return!!b[a]},add:c,remove:function(a){var c=this.contains(a);return delete b[a],c},clear:function(){b={}},forEach:function(a){for(var c in b)a(c)}}}),f=a.extend(function(){var a,b=function(b,e){return null==a&&(a=new d),a.get(b,function(){return new c}).push(e),this},e=function(b,c){if(a){if(!c)return void a.remove(b);var d=a.get(b);if(d)return d.remove(c),d.isEmpty&&a.remove(b),this}},f=function(a,b,c){if(Array.isArray(b))return void b.forEach(function(b){a(b,c)});if(null!=c);else if(d.isTypeOf(b))b.forEach(a);else for(var e in b)a(e,b[e])};return{on:function(a,c){return f(b,a,c),this},off:function(a,b){return f(e,a,b),this},trigger:function(b,c){if(a){var d=a.get(b);if(d)return d.forEach(function(a){a(c)}),this}}}}),g=function(a){return null==a?new c:c.isTypeOf(a)?a:new c(Array.isArray(a)?a:[a])},h=f.extend(function(a){this.super();var b=g(a);return Object.defineProperty(this,"internal",{get:function(){return b}}),{load:function(a,c){b=g(a),trigger("load",{name:"load",data:b,source:c})},update:function(a,c){var d=b.indexOf(a);0>d||trigger("update",{name:"update",data:a,index:d,source:c})},add:function(a,b,c){"number"!=typeof b&&null!=c&&(c=b,b=null),this._add(a,b),trigger("add",{name:"add",data:a,index:b,source:c})},_add:function(a,c){b.add(a,c)},remove:function(a,c){var d=b.indexOf(a);0>d||(this._remove(a),trigger("remove",{name:"remove",data:a,index:d,source:c}))},_remove:function(a){b.remove(a)}}}),i=a.extend(function(a,b){a&&Array.isArray(a)&&a.length&&(a=a[0]),a&&(this.element=a),b&&(this.model=b)}),j=function(){},k=function(a,b){if(null==a)return null;b=b||{};var c=Array.isArray(b.in)&&b.in,d=Array.isArray(b.ex)&&new e(b.ex),f={};return(c||Object.keys(a)).forEach(function(b){d&&d.contains(b)||(f[b]=a[b])}),f},l=i.extend(function(a,b,c){var d=b||new h,e=function(a){d&&d[a](this._listeners)};Object.defineProperty(this,"model",{get:function(){return d},set:function(a){e("off"),d=a,e("on")}}),this.super(a,b),this.renderer=c;var f={create:function(a){var b=document.createElement("div");return b._item=a,b},update:function(a,b){a.innerHTML=""+b},show:j,hide:j},g=function(a){return this.renderer&&this.renderer[a]||f[a]};return{_listeners:_clonePlainObject({load:function(a){this.load(a.data,a.source)},update:function(a){this.update(a.item,a.index,a.source)},add:function(a){this.add(a.item,a.index,a.source)},remove:function(a){this.remove(a.item,a.index,a.source)}}),clear:function(){this.element.innerHTML=""},load:function(a){if(this.clear(),null!=a&&Array.isArray(a)){var b=g.create,c=g.update,d=g.show,e=this.element;a.forEach(function(a){var f=b(a,this);c(f,a,this),e.appendChild(f),d(f,a,this)})}},update:function(a,b){var c=this.element.children[b];g.update(c,a,this)},add:function(a,b){var c=g.create(a,this),d=this.element.children[b];g.update(c,a,this),this.element.insertBefore(c,d),g.show(c,a,this)},remove:function(a,b){var c=this.element.children[b];null!=c&&(g.hide(c,a,this),this.element.removeChild(c))}}});return{Class:a,List:c,Map:d,Set:e,Model:f,ListModel:h,View:i,ListView:l,u:{"void":j,simpleClone:k}}});